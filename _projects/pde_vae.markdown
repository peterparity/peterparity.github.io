---
layout: post
title: Extracting Interpretable Physical Parameters
description: Using a variational autoencoder, we identify and extract unknown physical parameters governing spatiotemporal dynamics.
date: 2020-09-11
img: /assets/img/projects/pde_vae/key_image.svg
github: https://github.com/peterparity/PDE-VAE-pytorch
paper: https://journals.aps.org/prx/pdf/10.1103/PhysRevX.10.031056
importance: 2

_styles: >
  figure {
    display: block;
    margin: 2rem auto 2rem auto;
    max-width: 100%;
    height: auto;
  }
  img {
    max-width: 100%;
    height: auto;
    margin-bottom: 10px;
  }
  figcaption {
    font-size: 11pt;
    font-weight: bold;
    border-top: solid;
    border-width: 1px;
    padding-top: 5px;
  }

---
<div class="publications">
{% bibliography -f papers -q @article[doi=10.1103/PhysRevX.10.031056] %}
</div>
---

{% katexmm %}

Scientists have long strived not only to model and predict complex systems, such as fluid flow and electromagnetism, but also break them down and understand their fundamental aspects. However, in the face of complex spatiotemporal dynamics, like those governing weather phenomena and nonlinear optics, it becomes very difficult to distinguish between the inherent dynamics and changes caused by varying external influences.

Applying recent advances in machine learning combined with a physics-informed model design, we demonstrate a new tool for data analysis and spatiotemporal modeling that disentangles the effects of unknown and uncontrolled variables. Our method is an example of how new data-driven techniques allow scientists to better predict and understand the underlying physics behind complex dynamical systems.

<figure style="max-width: 576px">
  <img src="{{ site.url }}/assets/img/projects/pde_vae/key_image_with_labels.svg" style="background-color:white"/>
  <figcaption>Extracting relevant parameters governing the dynamics of spatiotemporal data (with uncontrolled variables), and learning a tunable, transferable predictive model.</figcaption>
</figure>


## Architecture

Though machine learning is traditionally thought of as a black-box method used for image recognition or time-series prediction, modern unsupervised learning techniques can be adapted to provide interpretable results for physical systems by incorporating key physical constraints. Specializing in datasets from spatiotemporal systems, our method is designed to extract interpretable physical parameters and to provide a tunable predictive model of the dynamics, all without prior knowledge of the underlying system. For example, given raw data generated by a chaotic model for a flame front, we show that our method automatically identifies and extracts a varying viscosity damping parameter that controls the propagation dynamics.

We implement a physics-informed architecture based on variational autoencoders (VAEs) that is designed for analyzing systems governed by partial differential equations (PDEs). The architecture is trained end-to-end and extracts latent parameters that parameterize the dynamics of a learned predictive model for the system.

<figure style="max-width: 800px">
  <img src="{{ site.url }}/assets/img/projects/pde_vae/architecture.svg" style="background-color:white"/>
  <figcaption>Physics-informed VAE architecture.</figcaption>
</figure>

## Experiments
To test our method, we train our model on simulated data from a variety of PDEs with varying dynamical parameters that act as uncontrolled variables. In particular, we generate datasets using the 1D Kuramoto–Sivashinsky (KS) equation (with varying viscosity damping parameter $\gamma$ acting as an uncontrolled variable)
$$
  \frac{\partial u}{\partial t} = -\gamma \partial_x^4 u - \partial_x^2 u - u\partial_x u,
$$
the 1D nonlinear Schrödinger (NS) equation (with varying nonlinearity coefficient $\kappa$)
$$
  i \frac{\partial \psi}{\partial t} = -\frac{1}{2} \partial_x^2\psi + \kappa|\psi|^2\psi,
$$
and the 2D convection–diffusion (CD) equation (with varying diffusion constant $D$ and drift velocity $\mathbf{v}$)
$$
  \frac{\partial u}{\partial t} = D\nabla^2u - \mathbf{v} \cdot \nabla u.
$$

<figure style="max-width: 800px">
  <img src="{{ site.url }}/assets/img/projects/pde_vae/examples_fig.svg" style="background-color:white"/>
  <figcaption>PDE prediction examples using the learned predictive models.</figcaption>
</figure>

Numerical experiments show that our method can accurately identify relevant parameters and extract them from raw and even noisy spatiotemporal data (tested with roughly 10% added noise).

<figure style="max-width: 400px">
  <img src="{{ site.url }}/assets/img/projects/pde_vae/relparam_fig.svg" style="background-color:white"/>
  <figcaption>Identifying relevant parameters, which have <span style="color: #4e7be8">large variance of µ<sub>z</sub> (blue)</span> and <span style="color: #ec4c4c">small mean of σ<sub>z</sub><sup style='position: relative; left: -.5em;'>2</sup>(red)</span>.</figcaption>
</figure>

These extracted parameters correlate well (linearly with R<sup>2</sup> > 0.95) with the ground truth physical parameters used to generate the datasets.

<figure style="max-width: 800px">
  <img src="{{ site.url }}/assets/img/projects/pde_vae/paramfit_fig.svg" style="background-color:white"/>
  <figcaption>Predicted relevant parameters (extracted from the latent parameters of the VAE by a linear fit) vs. the ground truth physical parameters.</figcaption>
</figure>

We then apply this method to nonlinear fiber propagation data, generated by an ab-initio simulation, to demonstrate its capabilities on a more realistic dataset.

<figure style="max-width: 800px">
  <img src="{{ site.url }}/assets/img/projects/pde_vae/nonlinear_fiber_fig.svg" style="background-color:white"/>
  <figcaption>Application to nonlinear optical fiber propagation.</figcaption>
</figure>

Our method for discovering interpretable latent parameters in spatiotemporal systems will allow us to better analyze and understand real-world phenomena and datasets, which often have unknown and uncontrolled variables that alter the system dynamics and cause varying behaviors that are difficult to disentangle.

Please see [our paper](https://journals.aps.org/prx/pdf/10.1103/PhysRevX.10.031056) for more details.


{% endkatexmm %}
