<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Peter Y. Lu | Training Emulators for Chaotic Dynamics</title>
<meta name="description" content="">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<!-- <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/.css" /> -->
<link rel="stylesheet" href="/assets/css/monokai.css" />

<!-- Styles -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
<link rel="manifest" href="/assets/img/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/projects/emulators_for_chaos/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Peter</span> Y.  Lu
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      
<style type="text/css">
  figure {
  display: block;
  margin: 2rem auto 2rem auto;
  max-width: 100%;
  height: auto;
} img {
  max-width: 100%;
  height: auto;
  margin-bottom: 10px;
} figcaption {
  font-size: 11pt;
  font-weight: bold;
  border-top: solid;
  border-width: 1px;
  padding-top: 5px;
}

</style>


<div class="post">

  <header class="post-header">
    <h1 class="post-title">Training Emulators for Chaotic Dynamics</h1>
    <p class="post-meta">March 7, 2024</p>
    <hr>
  </header>

  <article class="post-content">
    <div class="publications">
<ol class="bibliography"><li><div class="row">
    <div class="col-sm-2 abbr">
        
    </div>

    <div id="jiang2023training" class="col-sm-8">
        
            <div class="title">Training neural operators to preserve invariant measures of chaotic attractors</div>
            <div class="author">
                
                    
                    
                    
                    
                        
                            
                                
                                
                    

                    
                        
                            
                                
                                    <a href="https://roxie62.github.io/" target="_blank">Ruoxi
                                        Jiang*</a>,
                                
                            
                        
                    
                
                    
                    
                    
                    

                    
                        
                            
                                <em>Peter Y.
                                    Lu*</em>,
                            
                        
                    
                
                    
                    
                    
                    
                        
                            
                                
                                
                    

                    
                        
                            
                                
                                    <a href="https://www.linkedin.com/in/elena-orlova-32b901128" target="_blank">Elena
                                        Orlova</a>,
                                
                            
                        
                    
                
                    
                    
                    
                    
                        
                            
                                
                                
                    

                    
                        
                            
                                
                                    and
                                    <a href="https://willett.psd.uchicago.edu/" target="_blank">Rebecca
                                        Willett</a>
                                
                            
                        
                    
                
            </div>

            <div class="periodical">
                
                    <em>Thirty-seventh Conference on Neural Information Processing Systems</em>
                
                
                    (2023)
                
                
            </div>
        

        <div class="links">
            
                <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a>
            
            
            
                <a href="https://proceedings.neurips.cc/paper_files/paper/2023/hash/57d7e7e1593ad1ab6818c258fa5654ce-Abstract-Conference.html" class="btn btn-sm z-depth-0" role="button" target="_blank">HTML</a>
            
            
                
                    <a href="https://proceedings.neurips.cc/paper_files/paper/2023/file/57d7e7e1593ad1ab6818c258fa5654ce-Paper-Conference.pdf" class="btn btn-sm z-depth-0" role="button" target="_blank">PDF</a>
                
            
            
            
            
            
                
                    <a href="https://neurips.cc/media/neurips-2023/Slides/72621.pdf" class="btn btn-sm z-depth-0" role="button" target="_blank">Poster</a>
                
            
            
                
                    <a href="/assets/pdf/emulators_for_chaos_marchmeeting2024_allpng_no_extras.pdf" class="btn btn-sm z-depth-0" role="button" target="_blank">Slides</a>
                
            
            
            
        </div>

        <!-- Hidden abstract block -->
        
            <div class="abstract hidden">
                <p>Chaotic systems make long-horizon forecasts difficult because small perturbations in initial conditions cause trajectories to diverge at an exponential rate. In this setting, neural operators trained to minimize squared error losses, while capable of accurate short-term forecasts, often fail to reproduce statistical or structural properties of the dynamics over longer time horizons and can yield degenerate results. In this paper, we propose an alternative framework designed to preserve invariant measures of chaotic attractors that characterize the time-invariant statistical properties of the dynamics. Specifically, in the multi-environment setting (where each sample trajectory is governed by slightly different dynamics), we consider two novel approaches to training with noisy data. First, we propose a loss based on the optimal transport distance between the observed dynamics and the neural operator outputs. This approach requires expert knowledge of the underlying physics to determine what statistical features should be included in the optimal transport loss. Second, we show that a contrastive learning framework, which does not require any specialized prior knowledge, can preserve statistical properties of the dynamics nearly as well as the optimal transport approach. On a variety of chaotic systems, our method is shown empirically to preserve invariant measures of chaotic attractors.</p>
            </div>
        
    </div>
</div>
</li></ol>
</div>
<hr />

<p><strong>This popular summary is adapted from a <a href="https://datascience.uchicago.edu/insights/modeling-chaos-using-machine-learning-emulators/">blog post</a> written for the UChicago Data Science Institute.</strong></p>

<p>Chaos is everywhere, from natural processes—such as fluid flow, weather and climate, and biology—to man-made systems—such as the economy, road traffic, and manufacturing. Understanding and accurately modeling chaotic dynamics is critical for addressing many problems in science and engineering. Machine learning models trained to emulate dynamical systems offer a promising new data-driven approach for developing fast and accurate models of chaotic dynamics. However, these trained models, often called <em>emulators</em> or <em>surrogate models</em>, sometimes struggle to properly capture chaos leading to unrealistic predictions. In <a href="https://proceedings.neurips.cc/paper_files/paper/2023/hash/57d7e7e1593ad1ab6818c258fa5654ce-Abstract-Conference.html">our recent work</a> published at NeurIPS 2023, we propose two new methods for training emulators to accurately model chaotic systems, including an approach inspired by methods in computer vision used for image recognition and generative AI.</p>

<p>Machine learning approaches that use observational or experimental data to emulate dynamical systems have become increasingly popular over the past few years. These emulators aim to capture the dynamics of complex, high-dimensional systems like weather and climate. In principle, emulators will allow us to perform fast and accurate simulations for forecasting, uncertainty quantification, and parameter estimation. However, training emulators to model chaotic systems has proved to be tricky, especially in noisy settings.</p>

<p>One key feature of chaotic dynamics is their high sensitivity to initial conditions which is often referred to colloquially as the “butterfly effect”: small changes to an initial state—like a butterfly flapping its wings—can cause large changes in future states—like the location of a tornado. This means that even a tiny amount of noise in the data makes long-term forecasting impossible and precise short-term predictions very difficult. Accurate forecasts of chaotic systems, like the weather, are fundamentally limited by the properties of the chaos. If this is the case, should we simply give up on making long-term predictions?</p>

<p>The answer is both yes and no. Yes, even with machine learning, we will never be able to predict whether it will rain in Chicago more than a few weeks ahead of time (Sorry to all the couples planning outdoor summer weddings!). No, we should not give up completely because, while exact forecasts are impossible, we can still make useful statistical predictions about the future, such as the increasing frequency of hurricanes due to climate change. In fact, these statistical properties—collectively known as the <em>chaotic attractor</em>—are precisely what scientists focus on when developing models for chaotic systems.</p>

<figure style="max-width: 600px">
  <img src="/assets/img/projects/emulators_for_chaos/lorenz_chaos_combined.svg" style="background-color:white" />
  <figcaption>Demonstrating the butterfly effect: Two trajectories from the Lorenz-63 chaotic system with slightly different initial conditions that quickly diverge (left) but are statistically similar because they both lie on the same chaotic attractor (right).</figcaption>
</figure>

<p>Despite these well-known properties of chaotic dynamics, most current approaches for training emulators still focus on short-term forecasting metrics such as the root mean squared error (RMSE). For extremely clean data with high-resolution measurements, the standard training methods are sufficient to learn the correct dynamics since chaotic systems are, after all, deterministic. However, when using noisy or low-resolution data, which is the norm in real-world applications, these training methods often produce emulators that fail to capture the correct long-term statistical behaviors of the system.</p>

<figure style="max-width: 600px">
  <img src="/assets/img/projects/emulators_for_chaos/1step_v_auto_pred_demo.svg" style="width: 100%; background-color: white;" />
  <figcaption>An emulator trained on the Lorenz-63 system with good short-term predictions (1-Step) but poor long-term behavior (Autonomous).</figcaption>
</figure>

<p>We address this problem by developing new training methods that encourage the emulator to match long-term statistical properties of the chaotic dynamics—which, again, we refer to as the chaotic attractor. We propose two approaches for achieving this:</p>

<ol>
  <li>
    <p><strong>Physics-informed Optimal Transport</strong>: Choose a set of relevant summary statistics based on expert knowledge: for example, a climate scientist might pick the global mean temperature or the frequency of hurricanes. Then, during training, use an <em>optimal transport</em> metric—a way of quantifying discrepancies between distributions—to match the distribution of the summary statistics produced by the emulator to the distribution seen in the data.</p>
  </li>
  <li>
    <p><strong>Unsupervised Contrastive Learning</strong>: Automatically choose relevant statistics that characterize the chaotic attractor by using <em>contrastive learning</em>, a machine learning approach initially developed for learning useful image representations for image recognition tasks and generative AI. Then, during training, match the statistics of the emulator to the statistics of the data.</p>
  </li>
</ol>

<figure style="max-width: 800px">
  <img src="/assets/img/projects/emulators_for_chaos/emulatorforchaos_invariant_diagram.png" style="background-color:white" />
  <figcaption>Our proposed methods for training emulators (specifically, neural operators) to capture chaotic dynamics.</figcaption>
</figure>

<p>The distinction between the two methods lies primarily in how we choose the relevant statistics: either we pick (1) based on expert scientific knowledge or (2) automatically using machine learning. In both cases, we train emulators to generate predictions that match the long-term statistics of the data rather than just short-term forecasts. This results in much more robust emulators that, even when trained on noisy data, produce predictions with the same statistical properties as the real underlying chaotic dynamics.</p>

<figure style="max-width: 400px">
  <img src="/assets/img/projects/emulators_for_chaos/emulatorforchaos_fig1_kse.png" style="width: 100%; background-color: white;" />
  <figcaption>True dynamics of the Kuramoto–Sivashinsky chaotic system (Truth) alongside the predicted dynamics from an emulator trained using the standard method (RMSE) and one trained with our contrastive learning (CL) approach. Standard RMSE training fails to accurately capture the long-term statistical properties of the dynamics.</figcaption>
</figure>

<p>The best we can hope for when modeling chaos is either short-term forecasts or long-term statistical predictions, and emulators trained using the newly proposed methods give us the best of both worlds. Emulators are already being used in a wide range of applications such as weather prediction, climate modeling, fluid dynamics, and biophysics. Our approach and other promising recent developments in emulator design and training are bringing us closer to the goal of having fast and accurate data-driven models for complex dynamical systems, which will help us answer many basic scientific questions as well as solve challenging engineering problems.</p>

<p>Please see <a href="https://proceedings.neurips.cc/paper_files/paper/2023/file/57d7e7e1593ad1ab6818c258fa5654ce-Paper-Conference.pdf">our paper</a> for more details.</p>


  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2024 Peter Y. Lu.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
    <!-- Masonry & imagesLoaded -->
    <script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
    <script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    <script defer src="/assets/js/masonry.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
